rule AsyncRAT_Vietnam_2026 {
    meta:
        description = "Detects AsyncRAT samples compiled from AsyncRAT-C# project"
        author = "Peris.ai Threat Research Team"
        date = "2026-02-10"
        severity = "HIGH"
        hash = "1ab4672076f63692e67555ebea72d9d7593928012ea7277776057e354d70364d"
        reference = "https://github.com/perisai-labs/indra-cti"

    strings:
        $pdb = "AsyncRAT-C-Sharp" ascii
        $class1 = "Anti_Analysis" ascii
        $class2 = "MutexControl" ascii
        $class3 = "Client.Connection" ascii
        $class4 = "Client.Install" ascii
        $crypto1 = "Aes256" ascii
        $crypto2 = "HMACSHA256" ascii
        $crypto3 = "Serversignature" ascii
        $config1 = "Pastebin" ascii
        $config2 = "InstallFolder" ascii
        $config3 = "InstallFile" ascii
        $func1 = "DetectDebugger" ascii
        $func2 = "PreventSleep" ascii
        $func3 = "HwidGen" ascii
        $net = "v4.0.30319" ascii

    condition:
        uint16(0) == 0x5A4D and
        $net and
        (
            $pdb or
            (3 of ($class*) and 2 of ($crypto*)) or
            (2 of ($config*) and 2 of ($func*))
        )
}
