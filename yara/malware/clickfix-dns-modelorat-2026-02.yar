/*
 * YARA Rule: ClickFix DNS / ModeloRAT
 * Author: Peris.ai Research (Xhavero)
 * Date: 2026-02-17
 * Description: Detects ClickFix DNS variant persistence artifacts and ModeloRAT staging components
 * Reference: https://bleepingcomputer.com/news/security/new-clickfix-attack-abuses-nslookup-to-retrieve-powershell-payload-via-dns/
 * TLP: WHITE
 */

rule ClickFix_DNS_ModeloRAT_2026 {
    meta:
        description = "Detects ClickFix DNS variant / ModeloRAT persistence artifacts"
        author = "Peris.ai Research"
        date = "2026-02-17"
        reference = "https://bleepingcomputer.com/news/security/new-clickfix-attack-abuses-nslookup-to-retrieve-powershell-payload-via-dns/"
        tlp = "WHITE"
        mitre_attack = "T1071.004, T1059.001, T1547.009, T1059.006"

    strings:
        $startup_lnk = "MonitoringService.lnk" ascii wide nocase
        $vbs_path = "WPy64-31401" ascii wide nocase
        $script_vbs = "script.vbs" ascii wide nocase
        $dns_ip = "84.21.189.20" ascii wide

    condition:
        2 of them
}
